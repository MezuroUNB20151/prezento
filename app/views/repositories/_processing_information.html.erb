<script type="text/javascript">
  //Progress bar
  $(function() {
    var progressbar = $( "#progressbar" ),
      progressLabel = $( ".progress-label" );

    //Update label
    progressbar.progressbar({
      value: false,
      change: function() {
        progressLabel.text( progressbar.progressbar( "value" ) + "%" );
      },
      complete: function() {
        progressLabel.text( "Completo!" );
      }
    });

    function progress() {
      var val = progressbar.progressbar( "value" ) || 0;
      var estados = ['PREPARING', 'DOWNLOADING',
                     'COLLECTING', 'CHECKING',
                     'BUILDING','AGGREGATING',
                     'CALCULATING', 'INTERPRETING'];

      var contador = 0;
      var status = "<%= @processing.state %>";

      if(status == estados[0]){
          contador = 11.1;
      }else if( status ==  estados[1]) {
          contador = 22.2;
      }else if( status ==  estados[2]) {
          contador = 33.3;
      }else if( status ==  estados[3] ) {
          contador = 44.4;
      }else if( status ==  estados[4]) {
          contador = 55.5;
      }else if( status ==  estados[5]) {
          contador = 66.6;
      }else if( status ==  estados[6]) {
          contador = 77.7;
      }else if( status ==  estados[7]) {
          contador = 88.8;
      }else{
          contador = 100;
          $("#progressbar > div").css({ 'background': '#5EBFDB', 'border-color': '#5EBFDB'});
          $(".progress-label").css({ 'color': '#fff'});
      }

      progressbar.progressbar("value", contador);
    }

    setTimeout(progress);
  });
</script>

<p>
  <strong><%= t('activemodel.attributes.processing.state') %>:</strong>
  <%= @processing.state %>
</p>

<p>
  <strong><%= t('activemodel.attributes.processing.creation_date') %>:</strong>
  <%= @processing.created_at.strftime("%Y/%m/%d at %Hh%M (%z)") %>
</p>

<% unless @processing.process_times.nil? %>
  <% @processing.process_times.each do |process_time| %>
    <p>
      <strong><%= process_time.state %> time:</strong>
      <%= humanize_eplased_time(process_time.time) %>
    </p>
  <% end %>
<% end %>